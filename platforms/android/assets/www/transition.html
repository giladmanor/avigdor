<!DOCTYPE html>
<meta charset="utf-8">
<style>
	.mesh {
		fill: none;
		stroke: #000;
		stroke-width: .25px;
	}

	.start {
		fill: none;
		stroke: brown;
	}

	.end {
		fill: none;
		stroke: steelblue;
	}

</style>
<body>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="http://d3js.org/d3.hexbin.v0.min.js"></script>
	<script>
		var width = 960, height = 500, radius = 10;

		var p0 = [281, 59, 10], p1 = [422, 57, 10];

		var svg = d3.select("body").append("svg").attr("width", width).attr("height", height).append("g");
		//.call(transition, p0, p1);

		svg.append("path").attr("class", "mesh").attr("d", d3.hexbin().size([width, height]).radius(radius).mesh);

		svg.selectAll("circle").data([p0, p1]).enter().append("circle").attr("class", function(d, i) {
			return i ? "end" : "start";
		}).attr("cx", function(d) {
			return d[0];
		}).attr("cy", function(d) {
			return d[1];
		}).attr("r", function(d) {
			return d[2] / 2 - .5;
		});
		
		var showGI = function(point) {
			points = [point];
			//console.log(points);
			var hexbin = d3.hexbin().size([width, height]).radius(20);

			var svg = d3.select("svg").attr("width", width ).attr("height", height ).append("g");

			svg.append("clipPath").attr("id", "clip").append("rect").attr("class", "mesh").attr("width", width).attr("height", height);

			svg.append("g").attr("clip-path", "url(#clip)").selectAll(".hexagon").data(hexbin(points)).enter().append("path").attr("class", "hexagon").attr("d", hexbin.hexagon()).attr("transform", function(d) {
				return "translate(" + d.x + "," + d.y + ")";
			}).style("fill", function(d) {
				return "red";
			});
		};

		function transition(svg, start, end) {
			var center = [width / 2, height / 2], i = d3.interpolateZoom(start, end);
			svg.attr("transform", transform(start)).transition().delay(10).duration(i.duration ).attrTween("transform", function() {
				return function(t) {
					return transform(i(t));
				};
			});

			function transform(p) {
				var k = 1;
				console.log(">>","translate(" + (center[0] - p[0] * k) + "," + (center[1] - p[1] * k) + ")scale(" + k + ")");
				return "translate(" + (center[0] - p[0] * k) + "," + (center[1] - p[1] * k) + ")scale(" + k + ")";
			}

		}
		
		showGI(p0);

	</script>
	<button onclick="svg.call(transition, p0, p1)">
		1
	</button>
	<button onclick="svg.call(transition, p1, p0)">
		2
	</button>
